import base64
base64.b64decode(encoded_data.encode("I1NlcnZlciBTY3JpcHQgZmlsZXMgQnkgU2Nhbm5lcgppbXBvcnQgYnMKZnJvbSBic1NwYXogaW1wb3J0ICoKaW1wb3J0IGJzSW50ZXJuYWwKaW1wb3J0IGdldFBlcm1pc3Npb25zSGFzaGVzIGFzIGdwaAppbXBvcnQganNvbgppbXBvcnQgYnMsYnNJbnRlcm5hbAppbXBvcnQgcmFuZG9tCmZyb20gc2V0dGluZ3MgaW1wb3J0ICoKaW1wb3J0IHNldHRpbmdzCmltcG9ydCB0eXBlcwppbXBvcnQgdGltZQppbXBvcnQgdGhyZWFkaW5nCmltcG9ydCBoYWNrCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tQmFubmRlZCBQbGF5ZXIgS2lja2VyLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KYmFubmVkID0gbGlzdChzZXQoZ3BoLmJhbmxpc3QudmFsdWVzKCkpKQpvbGQgPSBbXQoKY2xhc3MgZGV0ZWN0KHRocmVhZGluZy5UaHJlYWQpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHRocmVhZGluZy5UaHJlYWQuX19pbml0X18oc2VsZikKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBnbG9iYWwgb2xkCiAgICAgICAgICAgIHJvc3RlciA9IGJzSW50ZXJuYWwuX2dldEdhbWVSb3N0ZXIoKQogICAgICAgICAgICBpZiByb3N0ZXIgIT0gb2xkOgogICAgICAgICAgICAgICAgI3ByaW50IHJvc3RlcgogICAgICAgICAgICAgICAgZm9yIGkgaW4gcm9zdGVyOgogICAgICAgICAgICAgICAgICAgIGEgPSBpWydkaXNwbGF5U3RyaW5nJ10KICAgICAgICAgICAgICAgICAgICBpZiBhIGluIGJhbm5lZDoKICAgICAgICAgICAgICAgICAgICAgICB3aXRoIGJzLkNvbnRleHQoJ1VJJyk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKGEgKyAiLCBZb3UgYXJlIGJhbm5lZCBkdWUgdG8gdm9pbGF0aW9uIG9mIHJ1bGVzLiIpIAogICAgICAgICAgICAgICAgICAgICAgIGJzSW50ZXJuYWwuX2Rpc2Nvbm5lY3RDbGllbnQoaW50KGlbJ2NsaWVudElEJ10pKQogICAgICAgICAgICAgICAgb2xkID0gcm9zdGVyCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwYXNzCiAgICAgICAgYnMucmVhbFRpbWVyKDIwMDAsc2VsZi5ydW4pCmRldGVjdCgpLnN0YXJ0KCkKCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tQXV0byBBZG1pbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCm9sZF9hZG1pbiA9IGdwaC5oZWxwZXIKb2xkX3ZpcCA9IGdwaC5tZW1iZXIKb2xkX3NwZWNpYWwgPSBncGguc3BlY2lhbAoKI0dpdmVzIGhlbHBlciBUbyBSYW5rIDEKZGVmIGhlbHBlcih2YWwpOgogICAgZmkgPSBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICcvcFN0YXRzLmpzb24nLCAncicpCiAgICBwYXRzID0ganNvbi5sb2FkcyhmaS5yZWFkKCkpCiAgICBmb3IgcGJfaWQgaW4gcGF0czoKICAgICAgICByYW5rX2NoZWNrID0gcGF0c1twYl9pZF1bInJhbmsiXQogICAgICAgIGlmIGludChyYW5rX2NoZWNrKSA9PSBpbnQodmFsKToKICAgICAgICAgICAga2V5MSA9IGxpc3QocGF0cy5rZXlzKCkpCiAgICAgICAgICAgIGZvciBpIGluIGtleTE6CiAgICAgICAgICAgICAgICBpZiBwYXRzW2ldWyJyYW5rIl0gPT0gdmFsOgogICAgICAgICAgICAgICAgICAgIG9sZF9hZG1pbi5hcHBlbmQoaSkKICAgICAgICAgICAgICAgICAgICBuZXdfYWRtaW4gPSBvbGRfYWRtaW4KICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAnL2dldFBlcm1pc3Npb25zSGFzaGVzLnB5JykgYXMgKGZpbGUpOgogICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgIHNbMF0gPSAnaGVscGVyID0gJysgc3RyKG5ld19hZG1pbikgKyAnXG4nCiAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgJy9nZXRQZXJtaXNzaW9uc0hhc2hlcy5weScsJ3cnKQogICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICBmLmNsb3NlKCkKICAgIGJzLnNjcmVlbk1lc3NhZ2UoIkFkbWlucyBVcGRhdGVkIixjb2xvciA9ICgwLDEsMCkpCgojR2l2ZXMgVmlwIFRvIFJhbmsgMgpkZWYgdmlwKHZhbCk6CiAgICBmaSA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgJy9wU3RhdHMuanNvbicsICdyJykKICAgIHBhdHMgPSBqc29uLmxvYWRzKGZpLnJlYWQoKSkKICAgIGZvciBwYl9pZCBpbiBwYXRzOgogICAgICAgIHJhbmtfY2hlY2sgPSBwYXRzW3BiX2lkXVsicmFuayJdCiAgICAgICAgaWYgaW50KHJhbmtfY2hlY2spID09IGludCh2YWwpOgogICAgICAgICAgICBrZXkxID0gbGlzdChwYXRzLmtleXMoKSkKICAgICAgICAgICAgZm9yIGkgaW4ga2V5MToKICAgICAgICAgICAgICAgIGlmIHBhdHNbaV1bInJhbmsiXSA9PSB2YWw6CiAgICAgICAgICAgICAgICAgICAgb2xkX3ZpcC5hcHBlbmQoaSkKICAgICAgICAgICAgICAgICAgICBuZXdfdmlwID0gb2xkX3ZpcAogICAgd2l0aCBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICcvZ2V0UGVybWlzc2lvbnNIYXNoZXMucHknKSBhcyAoZmlsZSk6CiAgICAgICAgcyA9IFsgcm93IGZvciByb3cgaW4gZmlsZSBdCiAgICAgICAgc1sxXSA9ICdtZW1iZXIgPSAnKyBzdHIobmV3X3ZpcCkgKyAnXG4nCiAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgJy9nZXRQZXJtaXNzaW9uc0hhc2hlcy5weScsJ3cnKQogICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICBmLmNsb3NlKCkKICAgIGJzLnNjcmVlbk1lc3NhZ2UoIlZpcHMgVXBkYXRlZCIsY29sb3IgPSAoMCwxLDApKQogICAgCiNHaXZlcyBzcGVjaWFsIHN1cHBvcnQgCmRlZiBzcGVjaWFsKHZhbCk6CiAgICBmaSA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgJy9wU3RhdHMuanNvbicsICdyJykKICAgIHBhdHMgPSBqc29uLmxvYWRzKGZpLnJlYWQoKSkKICAgIGZvciBwYl9pZCBpbiBwYXRzOgogICAgICAgIHJhbmtfY2hlY2sgPSBwYXRzW3BiX2lkXVsicmFuayJdCiAgICAgICAgaWYgaW50KHJhbmtfY2hlY2spID09IGludCh2YWwpOgogICAgICAgICAgICBrZXkxID0gbGlzdChwYXRzLmtleXMoKSkKICAgICAgICAgICAgZm9yIGkgaW4ga2V5MToKICAgICAgICAgICAgICAgIGlmIHBhdHNbaV1bInJhbmsiXSA9PSB2YWw6CiAgICAgICAgICAgICAgICAgICAgb2xkX3NwZWNpYWwuYXBwZW5kKGkpCiAgICAgICAgICAgICAgICAgICAgbmV3X3NwZWNpYWwgPSBvbGRfc3BlY2lhbAogICAgd2l0aCBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICcvZ2V0UGVybWlzc2lvbnNIYXNoZXMucHknKSBhcyAoZmlsZSk6CiAgICAgICAgcyA9IFsgcm93IGZvciByb3cgaW4gZmlsZSBdCiAgICAgICAgc1sxOV0gPSAnc3BlY2lhbCA9ICcrIHN0cihuZXdfc3BlY2lhbCkgKyAnXG4nCiAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgJy9nZXRQZXJtaXNzaW9uc0hhc2hlcy5weScsJ3cnKQogICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICBmLmNsb3NlKCkKICAgIGJzLnNjcmVlbk1lc3NhZ2UoInNwZWNpYWwgc3VwcG9ydCBVcGRhdGVkIixjb2xvciA9ICgwLDEsMCkpICAgIAoKCiNicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAnL3BTdGF0cy5qc29uJwoiIiIKICAgIGZpID0gb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAnL3BTdGF0cy5qc29uJywgJ3InKQogICAgcGF0cyA9IGpzb24ubG9hZHMoZmkucmVhZCgpKQogICAgZm9yIHBiX2lkIGluIHBhdHM6CiAgICAgICAgcmFua19jaGVjayA9IHBhdHNbcGJfaWRdWyJyYW5rIl0KICAgICAgICBpZiBpbnQocmFua19jaGVjaykgPT0gMToKICAgICAgICAgICAga2V5MSA9IGxpc3QocGF0cy5rZXlzKCkpCiAgICAgICAgICAgIGZvciBpIGluIGtleTE6CiAgICAgICAgICAgICAgICBpZiBwYXRzW2ldWyJyYW5rIl0gPT0gIjEiOgogICAgICAgICAgICAgICAgICAgIG9sZF9hZG1pbi5hcHBlbmQoaSkKICAgICAgICAgICAgICAgICAgICBuZXdfYWRtaW4gPSBvbGRfYWRtaW4KIiIiCgoKCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tUG93ZXJ1cHMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpkZWYgblAodmFsKToKICAgIGlmIHZhbCA9PSAwOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzIyXSA9ICJuYW1lT25Qb3dlclVwcyA9IEZhbHNlIisiXG4iCiAgICAgICAgICAgIGYgPSBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIsInciKQogICAgICAgICAgICBmb3IgaSBpbiBzOgogICAgICAgICAgICAgICAgZi53cml0ZShpKQogICAgICAgICAgICBmLmNsb3NlKCkKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiTmFtZSBPbiBQb3dlclVwcyBTZXQgLS0tLT4gRmFsc2UiLGNvbG9yID0gKDEsMCwwKSkKICAgICAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKICAgIGVsaWYgdmFsID09IDE6CiAgICAgICAgd2l0aCBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIpIGFzIChmaWxlKToKICAgICAgICAgICAgcyA9IFsgcm93IGZvciByb3cgaW4gZmlsZSBdCiAgICAgICAgICAgIHNbMjJdID0gIm5hbWVPblBvd2VyVXBzID0gVHJ1ZSIrIlxuIgogICAgICAgICAgICBmID0gb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiLCJ3IikKICAgICAgICAgICAgZm9yIGkgaW4gczoKICAgICAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICAgICAgZi5jbG9zZSgpCiAgICAgICAgICAgIGJzLnNjcmVlbk1lc3NhZ2UoIk5hbWUgT24gUG93ZXJVcHMgU2V0IC0tLS0+IFRydWUiLGNvbG9yID0oMCwxLDApKQogICAgICAgICAgICBic0ludGVybmFsLl9jaGF0TWVzc2FnZSgiTm93IFJlc3RhcnQgU2VydmVyIFVzaW5nIC9xdWl0IHRvIHRha2UgRWZmZWN0IG9mIFNldHRpbmciKQojcG93ZXJ1cCB0aW1lcgpkZWYgcFQodmFsKToKICAgIGlmIHZhbCA9PSAwOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzI4XSA9ICJwb3dlcnVwVGltZXIgPSBGYWxzZSIrIlxuIgogICAgICAgICAgICBmID0gb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiLCJ3IikKICAgICAgICAgICAgZm9yIGkgaW4gczoKICAgICAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICAgICAgZi5jbG9zZSgpCiAgICAgICAgICAgIGJzLnNjcmVlbk1lc3NhZ2UoIlBvd2VydXAgVGltZXIgU2V0IC0tLS0+IEZhbHNlIixjb2xvciA9ICgxLDAsMCkpCiAgICAgICAgICAgIGJzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKCJOb3cgUmVzdGFydCBTZXJ2ZXIgVXNpbmcgL3F1aXQgdG8gdGFrZSBFZmZlY3Qgb2YgU2V0dGluZyIpCiAgICBlbGlmIHZhbCA9PSAxOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzI4XSA9ICJwb3dlcnVwVGltZXIgPSBUcnVlIisiXG4iCiAgICAgICAgICAgIGYgPSBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIsInciKQogICAgICAgICAgICBmb3IgaSBpbiBzOgogICAgICAgICAgICAgICAgZi53cml0ZShpKQogICAgICAgICAgICBmLmNsb3NlKCkKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiUG93ZXJ1cCBUaW1lciBTZXQgLS0tLT4gVHJ1ZSIsY29sb3IgPSAoMCwxLDApKQogICAgICAgICAgICBic0ludGVybmFsLl9jaGF0TWVzc2FnZSgiTm93IFJlc3RhcnQgU2VydmVyIFVzaW5nIC9xdWl0IHRvIHRha2UgRWZmZWN0IG9mIFNldHRpbmciKQoKI3NoaWVsZCBvbiBwb3dlcnVwcwpkZWYgc1AodmFsKToKICAgIGlmIHZhbCA9PSAwOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzI0XSA9ICJzaGllbGRPblBvd2VyVXBzID0gRmFsc2UiKyJcbiIKICAgICAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IiwidyIpCiAgICAgICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgICAgICBmLndyaXRlKGkpCiAgICAgICAgICAgIGYuY2xvc2UoKQogICAgICAgICAgICBicy5zY3JlZW5NZXNzYWdlKCJTaGllbGQgT24gUG93ZXJVcHMgU2V0IC0tLS0+IEZhbHNlIixjb2xvciA9ICgxLDAsMCkpCiAgICAgICAgICAgIGJzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKCJOb3cgUmVzdGFydCBTZXJ2ZXIgVXNpbmcgL3F1aXQgdG8gdGFrZSBFZmZlY3Qgb2YgU2V0dGluZyIpCiAgICBlbGlmIHZhbCA9PSAxOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzI0XSA9ICJzaGllbGRPblBvd2VyVXBzID0gVHJ1ZSIrIlxuIgogICAgICAgICAgICBmID0gb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiLCJ3IikKICAgICAgICAgICAgZm9yIGkgaW4gczoKICAgICAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICAgICAgZi5jbG9zZSgpCiAgICAgICAgICAgIGJzLnNjcmVlbk1lc3NhZ2UoIlNoaWVsZCBPbiBQb3dlclVwcyBTZXQgLS0tLT4gVHJ1ZSIsY29sb3IgPSAoMCwxLDApKQogICAgICAgICAgICBic0ludGVybmFsLl9jaGF0TWVzc2FnZSgiTm93IFJlc3RhcnQgU2VydmVyIFVzaW5nIC9xdWl0IHRvIHRha2UgRWZmZWN0IG9mIFNldHRpbmciKQojZGlzY28gICAgICAgICAgICAKZGVmIGRQKHZhbCk6CiAgICBpZiB2YWwgPT0gMDoKICAgICAgICB3aXRoIG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IikgYXMgKGZpbGUpOgogICAgICAgICAgICBzID0gWyByb3cgZm9yIHJvdyBpbiBmaWxlIF0KICAgICAgICAgICAgc1syNl0gPSAiZGlzY29MaWdodHNPblBvd2VyVXBzID0gRmFsc2UiKyJcbiIKICAgICAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IiwidyIpCiAgICAgICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgICAgICBmLndyaXRlKGkpCiAgICAgICAgICAgIGYuY2xvc2UoKQogICAgICAgICAgICBicy5zY3JlZW5NZXNzYWdlKCJTaGllbGQgT24gUG93ZXJVcHMgU2V0IC0tLS0+IEZhbHNlIixjb2xvciA9ICgxLDAsMCkpCiAgICAgICAgICAgIGJzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKCJOb3cgUmVzdGFydCBTZXJ2ZXIgVXNpbmcgL3F1aXQgdG8gdGFrZSBFZmZlY3Qgb2YgU2V0dGluZyIpCiAgICBlbGlmIHZhbCA9PSAxOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzI2XSA9ICJkaXNjb0xpZ2h0c09uUG93ZXJVcHMgPSBUcnVlIisiXG4iCiAgICAgICAgICAgIGYgPSBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIsInciKQogICAgICAgICAgICBmb3IgaSBpbiBzOgogICAgICAgICAgICAgICAgZi53cml0ZShpKQogICAgICAgICAgICBmLmNsb3NlKCkKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiU2hpZWxkIE9uIFBvd2VyVXBzIFNldCAtLS0tPiBUcnVlIixjb2xvciA9ICgwLDEsMCkpCiAgICAgICAgICAgIGJzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKCJOb3cgUmVzdGFydCBTZXJ2ZXIgVXNpbmcgL3F1aXQgdG8gdGFrZSBFZmZlY3Qgb2YgU2V0dGluZyIpCiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tQm9tYnMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAgICAgICAgICAgIAojYm9tYiBuYW1lCmRlZiBiTih2YWwpOgogICAgaWYgdmFsID09IDA6CiAgICAgICAgd2l0aCBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIpIGFzIChmaWxlKToKICAgICAgICAgICAgcyA9IFsgcm93IGZvciByb3cgaW4gZmlsZSBdCiAgICAgICAgICAgIHNbMjBdID0gImJvbWJOYW1lID0gRmFsc2UiKyJcbiIKICAgICAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IiwidyIpCiAgICAgICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgICAgICBmLndyaXRlKGkpCiAgICAgICAgICAgIGYuY2xvc2UoKQogICAgICAgICAgICBicy5zY3JlZW5NZXNzYWdlKCJCb21iTmFtZSBTZXQgLS0tLT4gRmFsc2UiLGNvbG9yID0gKDEsMCwwKSkKICAgICAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKICAgIGVsaWYgdmFsID09IDE6CiAgICAgICAgd2l0aCBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIpIGFzIChmaWxlKToKICAgICAgICAgICAgcyA9IFsgcm93IGZvciByb3cgaW4gZmlsZSBdCiAgICAgICAgICAgIHNbMjBdID0gImJvbWJOYW1lID0gVHJ1ZSIrIlxuIgogICAgICAgICAgICBmID0gb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiLCJ3IikKICAgICAgICAgICAgZm9yIGkgaW4gczoKICAgICAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICAgICAgZi5jbG9zZSgpCiAgICAgICAgICAgIGJzLnNjcmVlbk1lc3NhZ2UoIkJvbWJOYW1lIFNldCAtLS0tPiBUcnVlIixjb2xvciA9ICgwLDEsMCkpCiAgICAgICAgICAgIGJzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKCJOb3cgUmVzdGFydCBTZXJ2ZXIgVXNpbmcgL3F1aXQgdG8gdGFrZSBFZmZlY3Qgb2YgU2V0dGluZyIpCgojYm9tYiBsaWdodApkZWYgYkwodmFsKToKICAgIGlmIHZhbCA9PSAwOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzE4XSA9ICJib21iTGlnaHRzID0gRmFsc2UiKyJcbiIKICAgICAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IiwidyIpCiAgICAgICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgICAgICBmLndyaXRlKGkpCiAgICAgICAgICAgIGYuY2xvc2UoKQogICAgICAgICAgICBicy5zY3JlZW5NZXNzYWdlKCJCb21iTGlnaHRzIFNldCAtLS0tPiBGYWxzZSIsY29sb3IgPSAoMSwwLDApKQogICAgICAgICAgICBic0ludGVybmFsLl9jaGF0TWVzc2FnZSgiTm93IFJlc3RhcnQgU2VydmVyIFVzaW5nIC9xdWl0IHRvIHRha2UgRWZmZWN0IG9mIFNldHRpbmciKQogICAgZWxpZiB2YWwgPT0gMToKICAgICAgICB3aXRoIG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IikgYXMgKGZpbGUpOgogICAgICAgICAgICBzID0gWyByb3cgZm9yIHJvdyBpbiBmaWxlIF0KICAgICAgICAgICAgc1sxOF0gPSAiYm9tYkxpZ2h0cyA9IFRydWUiKyJcbiIKICAgICAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IiwidyIpCiAgICAgICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgICAgICBmLndyaXRlKGkpCiAgICAgICAgICAgIGYuY2xvc2UoKQogICAgICAgICAgICBicy5zY3JlZW5NZXNzYWdlKCJCb21iTGlnaHRzIFNldCAtLS0tPiBUcnVlIixjb2xvciA9ICgwLDEsMCkpCiAgICAgICAgICAgIGJzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKCJOb3cgUmVzdGFydCBTZXJ2ZXIgVXNpbmcgL3F1aXQgdG8gdGFrZSBFZmZlY3Qgb2YgU2V0dGluZyIpCiNTaGllbGQgb24gQm9tYiAgICAgICAgICAgIApkZWYgc0IodmFsKToKICAgIGlmIHZhbCA9PSAwOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzE2XSA9ICJzaGllbGRCb21iID0gRmFsc2UiKyJcbiIKICAgICAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IiwidyIpCiAgICAgICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgICAgICBmLndyaXRlKGkpCiAgICAgICAgICAgIGYuY2xvc2UoKQogICAgICAgICAgICBicy5zY3JlZW5NZXNzYWdlKCJTaGllbGQgb24gQm9tYiBTZXQgLS0tLT4gRmFsc2UiLGNvbG9yID0gKDEsMCwwKSkKICAgICAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKICAgIGVsaWYgdmFsID09IDE6CiAgICAgICAgd2l0aCBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIpIGFzIChmaWxlKToKICAgICAgICAgICAgcyA9IFsgcm93IGZvciByb3cgaW4gZmlsZSBdCiAgICAgICAgICAgIHNbMTZdID0gInNoaWVsZEJvbWIgPSBUcnVlIisiXG4iCiAgICAgICAgICAgIGYgPSBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIsInciKQogICAgICAgICAgICBmb3IgaSBpbiBzOgogICAgICAgICAgICAgICAgZi53cml0ZShpKQogICAgICAgICAgICBmLmNsb3NlKCkKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiU2hpZWxkIG9uIEJvbWIgU2V0IC0tLS0+IFRydWUiLGNvbG9yID0gKDAsMSwwKSkKICAgICAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1TZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICAgICAgICAgICAgICAgICAgICAgICAgCiNuaWdodCBtb2QKZGVmIG5NKHZhbCk6CiAgICBpZiB2YWwgPT0gMDoKICAgICAgICB3aXRoIG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IikgYXMgKGZpbGUpOgogICAgICAgICAgICBzID0gWyByb3cgZm9yIHJvdyBpbiBmaWxlIF0KICAgICAgICAgICAgc1s5XSA9ICJuaWdodE1vZGUgPSBGYWxzZSIrIlxuIgogICAgICAgICAgICBmID0gb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2hhY2sucHkiLCJ3IikKICAgICAgICAgICAgZm9yIGkgaW4gczoKICAgICAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICAgICAgZi5jbG9zZSgpCiAgICAgICAgICAgIGJzLnNjcmVlbk1lc3NhZ2UoIkFsd2F5cyBOaWdodCBNb2RlIFNldCAtLS0tPiBGYWxzZSIsY29sb3IgPSAoMSwwLDApKQogICAgICAgICAgICBic0ludGVybmFsLl9jaGF0TWVzc2FnZSgiTm93IFJlc3RhcnQgU2VydmVyIFVzaW5nIC9xdWl0IHRvIHRha2UgRWZmZWN0IG9mIFNldHRpbmciKQogICAgZWxpZiB2YWwgPT0gMToKICAgICAgICB3aXRoIG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IikgYXMgKGZpbGUpOgogICAgICAgICAgICBzID0gWyByb3cgZm9yIHJvdyBpbiBmaWxlIF0KICAgICAgICAgICAgc1s5XSA9ICJuaWdodE1vZGUgPSBUcnVlIisiXG4iCiAgICAgICAgICAgIGYgPSBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIsInciKQogICAgICAgICAgICBmb3IgaSBpbiBzOgogICAgICAgICAgICAgICAgZi53cml0ZShpKQogICAgICAgICAgICBmLmNsb3NlKCkKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiQWx3YXlzIE5pZ2h0IE1vZGUgU2V0IC0tLS0+IFRydWUiLGNvbG9yID0gKDAsMSwwKSkKICAgICAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKI2FuaW1hdGUgICAgICAgICAgICAKZGVmIGFUKHZhbCk6CiAgICBpZiB2YWwgPT0gMDoKICAgICAgICB3aXRoIG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IikgYXMgKGZpbGUpOgogICAgICAgICAgICBzID0gWyByb3cgZm9yIHJvdyBpbiBmaWxlIF0KICAgICAgICAgICAgc1sxM10gPSAiYW5pbWF0ZSA9IEZhbHNlIisiXG4iCiAgICAgICAgICAgIGYgPSBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvaGFjay5weSIsInciKQogICAgICAgICAgICBmb3IgaSBpbiBzOgogICAgICAgICAgICAgICAgZi53cml0ZShpKQogICAgICAgICAgICBmLmNsb3NlKCkKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiYW5pbWF0ZSBNb2RlIFNldCAtLS0tPiBGYWxzZSIsY29sb3IgPSAoMSwwLDApKQogICAgICAgICAgICBic0ludGVybmFsLl9jaGF0TWVzc2FnZSgiTm93IFJlc3RhcnQgU2VydmVyIFVzaW5nIC9xdWl0IHRvIHRha2UgRWZmZWN0IG9mIFNldHRpbmciKQogICAgZWxpZiB2YWwgPT0gMToKICAgICAgICB3aXRoIG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IikgYXMgKGZpbGUpOgogICAgICAgICAgICBzID0gWyByb3cgZm9yIHJvdyBpbiBmaWxlIF0KICAgICAgICAgICAgc1sxM10gPSAiYW5pbWF0ZSA9IFRydWUiKyJcbiIKICAgICAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9oYWNrLnB5IiwidyIpCiAgICAgICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgICAgICBmLndyaXRlKGkpCiAgICAgICAgICAgIGYuY2xvc2UoKQogICAgICAgICAgICBicy5zY3JlZW5NZXNzYWdlKCJhbmltYXRlIE1vZGUgU2V0IC0tLS0+IFRydWUiLGNvbG9yID0gKDAsMSwwKSkKICAgICAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKI1N0YXRzIApkZWYgc1ModmFsKToKICAgIGlmIHZhbCA9PSAwOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL3NldHRpbmdzLnB5IikgYXMgKGZpbGUpOgogICAgICAgICAgICBzID0gWyByb3cgZm9yIHJvdyBpbiBmaWxlIF0KICAgICAgICAgICAgc1sxMF0gPSAiZW5hYmxlU3RhdHMgPSBGYWxzZSIrIlxuIgogICAgICAgICAgICBmID0gb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL3NldHRpbmdzLnB5IiwidyIpCiAgICAgICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgICAgICBmLndyaXRlKGkpCiAgICAgICAgICAgIGYuY2xvc2UoKQogICAgICAgICAgICBicy5zY3JlZW5NZXNzYWdlKCJTdGF0cyBTZXQgVG8gLS0tLT4gRmFsc2UiLGNvbG9yID0gKDEsMCwwKSkKICAgICAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKICAgIGVsaWYgdmFsID09IDE6CiAgICAgICAgd2l0aCBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvc2V0dGluZ3MucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzEwXSA9ICJlbmFibGVTdGF0cyA9IFRydWUiKyJcbiIKICAgICAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9zZXR0aW5ncy5weSIsInciKQogICAgICAgICAgICBmb3IgaSBpbiBzOgogICAgICAgICAgICAgICAgZi53cml0ZShpKQogICAgICAgICAgICBmLmNsb3NlKCkKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiU3RhdHMgU2V0IFRvIC0tLS0+IFRydWUiLGNvbG9yID0gKDAsMSwwKSkKICAgICAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKI2NvaW4gc3lzdGVtIApkZWYgY1ModmFsKToKICAgIGlmIHZhbCA9PSAwOgogICAgICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL3NldHRpbmdzLnB5IikgYXMgKGZpbGUpOgogICAgICAgICAgICBzID0gWyByb3cgZm9yIHJvdyBpbiBmaWxlIF0KICAgICAgICAgICAgc1s4XSA9ICJlbmFibGVDb2luU3lzdGVtID0gRmFsc2UiKyJcbiIKICAgICAgICAgICAgZiA9IG9wZW4oYnMuZ2V0RW52aXJvbm1lbnQoKVsnc3lzdGVtU2NyaXB0c0RpcmVjdG9yeSddICsgIi9zZXR0aW5ncy5weSIsInciKQogICAgICAgICAgICBmb3IgaSBpbiBzOgogICAgICAgICAgICAgICAgZi53cml0ZShpKQogICAgICAgICAgICBmLmNsb3NlKCkKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiQ29pbiBTeXN0ZW0gLS0tLT4gRGlzYWJsZWQiLGNvbG9yID0gKDEsMCwwKSkKICAgICAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKICAgIGVsaWYgdmFsID09IDE6CiAgICAgICAgd2l0aCBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvc2V0dGluZ3MucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgICAgIHMgPSBbIHJvdyBmb3Igcm93IGluIGZpbGUgXQogICAgICAgICAgICBzWzhdID0gImVuYWJsZUNvaW5TeXN0ZW0gPSBUcnVlIisiXG4iCiAgICAgICAgICAgIGYgPSBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvc2V0dGluZ3MucHkiLCJ3IikKICAgICAgICAgICAgZm9yIGkgaW4gczoKICAgICAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICAgICAgZi5jbG9zZSgpCiAgICAgICAgICAgIGJzLnNjcmVlbk1lc3NhZ2UoIkNvaW4gU3lzdGVtICAtLS0tPiBFbmFibGVkIixjb2xvciA9ICgwLDEsMCkpCiAgICAgICAgICAgIGJzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKCJOb3cgUmVzdGFydCBTZXJ2ZXIgVXNpbmcgL3F1aXQgdG8gdGFrZSBFZmZlY3Qgb2YgU2V0dGluZyIpCiAgICAgICAgICAgIAojdGVhbSBuYW1lIApkZWYgdE4oTmFtZTEsTmFtZTIpOgogICAgTjEgPSAiJyIrTmFtZTErIiciCiAgICBOMiA9ICInIitOYW1lMisiJyIKICAgIHdpdGggb3Blbihicy5nZXRFbnZpcm9ubWVudCgpWydzeXN0ZW1TY3JpcHRzRGlyZWN0b3J5J10gKyAiL2JzVGVhbUdhbWUucHkiKSBhcyAoZmlsZSk6CiAgICAgICAgcyA9IFsgcm93IGZvciByb3cgaW4gZmlsZSBdCiAgICAgICAgc1sxMF0gPSAiZ0RlZmF1bHRUZWFtTmFtZXMgPSAodSIrTjErIix1IitOMisiKSIrIlxuIgogICAgICAgIGYgPSBvcGVuKGJzLmdldEVudmlyb25tZW50KClbJ3N5c3RlbVNjcmlwdHNEaXJlY3RvcnknXSArICIvYnNUZWFtR2FtZS5weSIsInciKQogICAgICAgIGZvciBpIGluIHM6CiAgICAgICAgICAgIGYud3JpdGUoaSkKICAgICAgICBmLmNsb3NlKCkKICAgICAgICBicy5zY3JlZW5NZXNzYWdlKCJUZWFtIE5hbWUgQ2hhbmdlZCBUbygiK05hbWUxKyIsIitOYW1lMisiKSIpCiAgICAgICAgYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIk5vdyBSZXN0YXJ0IFNlcnZlciBVc2luZyAvcXVpdCB0byB0YWtlIEVmZmVjdCBvZiBTZXR0aW5nIikKCgpnb2QgPSBbJ3BiLUlGNHJVMjBNSFE9PScsJ3BiLUlGNGVGRWdZJ10Kc2Nhbm5lciA9IFsncGItSUY0ZUZFZ1knXQpwY21vZGRkZXIgPSBbJ3BiLUlGNHJVMjBNSFE9PSddCgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUZpbHRlci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICAgIAoKd2FybmRpY3QgPSB7fQoKZGVmIGsoY2lkKToKICAgIGlmIGNpZCBpbiB3YXJuZGljdDoKICAgICAgICBwcmludChjaWQsIkFscmVhZHkgRXhzaXN0IikKICAgIGVsc2U6CiAgICAgICAgd2FybmRpY3QudXBkYXRlKHtjaWQ6MH0pCgpkZWYgY2hlY2soY2lkKToKICAgIGdsb2JhbCB3YXJuZGljdAogICAgaWYgaGFjay5lbmFibGVDaGF0RmlsdGVyOgogICAgICAgIGlmIHdhcm5kaWN0W2NpZF0gPT0gMToKICAgICAgICAgICAgYnNJbnRlcm5hbC5fZGlzY29ubmVjdENsaWVudChpbnQoY2lkKSkKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiS2lja2luZyBGb3IgTWlzYmVoYXZlIisgbmFtZSwgY29sb3IgPSAoMSwwLDApKQogICAgICAgICAgICB3YXJuZGljdC5wb3AoY2lkKQogICAgICAgIGVsaWYgd2FybmRpY3RbY2lkXSA9PSAwOgogICAgICAgICAgICB3YXJuZGljdFtjaWRdID0gMQoKZGVmIHdhcm4oY2xpZW50SUQpOgogICAgaWYgaGFjay5lbmFibGVDaGF0RmlsdGVyOgogICAgICAgIGJzLnNjcmVlbk1lc3NhZ2UoIldhcm5pbmchISEgRG8gTm90IE1pc2JlaGF2ZSIsIGNvbG9yID0gKDEsMCwwKSwgdHJhbnNpZW50PVRydWUsIGNsaWVudHM9W2NsaWVudElEXSkKICAgICAgICBpZiB3YXJuZGljdFtjbGllbnRJRF0gPT0gMDoKICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgiTGFzdCBDaGFuY2UgV2FybmluZyAxLzIiLCBjb2xvciA9ICgxLDAsMCksIHRyYW5zaWVudD1UcnVlLCBjbGllbnRzPVtjbGllbnRJRF0pCgojLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tU3BhbSBwcm90ZWN0aW9uLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY291bnRlciA9IHt9CnNwYW1tZXJzID0ge30KCgpkZWYgd2FybihJRCk6CglpZiBJRCBpbiBzcGFtbWVyczoKCQlzcGFtbWVyc1tJRF0gKz0gMQoJZWxzZToKCQlzcGFtbWVyc1tJRF0gPSAxCQoJcmV0dXJuIHNwYW1tZXJzW0lEXQoKZGVmIGdldElEKGNsSUQpOgoJI2FpZCA9IE5vbmUKCWZvciBpIGluIGJzSW50ZXJuYWwuX2dldEdhbWVSb3N0ZXIoKToKCSAgICBpZiBpWydjbGllbnRJRCddID09IGNsSUQ6CgkJZGlzcGxheVN0cmluZyA9IGlbJ2Rpc3BsYXlTdHJpbmcnXQoJCXJldHVybiBkaXNwbGF5U3RyaW5nCgoKZGVmIGNoZWNrU3BhbShjbGllbnRJRCk6CgkjbmFtZSA9IGdldElEKGNsaWVudElEKQoJI2ZpbmQgaWQgZnJvbSBjbGllbnRJRAoJZm9yIGkgaW4gYnNJbnRlcm5hbC5fZ2V0R2FtZVJvc3RlcigpOgoJICAgIGlmIGlbJ2NsaWVudElEJ10gPT0gY2xpZW50SUQ6CgkJSUQgPSBpWydkaXNwbGF5U3RyaW5nJ10KCQluYW1lID0gSUQKCQl0cnk6CgkJCW5hbWUgPSBpWydwbGF5ZXJzJ11bMF1bJ25hbWVGdWxsJ10KCQlleGNlcHQ6CgkJCXBhc3MKCQoJZ2xvYmFsIGNvdW50ZXIKCWlmIElEIGluIGNvdW50ZXI6IAoJCWNvdW50ZXJbSURdICs9IDEKCQlpZiBjb3VudGVyW0lEXSA9PSAzOgoJCQlicy5zY3JlZW5NZXNzYWdlKCJEb24ndCBTcGFtIEhlcmUhIixjb2xvciA9ICgxLDAsMCkpCgkJCXdhcm5Db3VudCA9IHdhcm4oSUQpCgkJCXdpdGggYnMuQ29udGV4dChic0ludGVybmFsLl9nZXRGb3JlZ3JvdW5kSG9zdEFjdGl2aXR5KCkpOmJzLnNjcmVlbk1lc3NhZ2UoIlBsZWFzZSBkb250IHNwYW0iLCB0cmFuc2llbnQ9VHJ1ZSwgY2xpZW50cz1bY2xpZW50SURdKQoJCQlyZXR1cm4gRmFsc2UKCQkJaWYgd2FybkNvdW50IDwgMjoKCQkJCWJzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKCJ7fSwgZG9uJ3Qgc3BhbSBoZXJlISIuZm9ybWF0KG5hbWUpKQoJCQkJd2l0aCBicy5Db250ZXh0KGJzSW50ZXJuYWwuX2dldEZvcmVncm91bmRIb3N0QWN0aXZpdHkoKSk6YnMuc2NyZWVuTWVzc2FnZSgiUGxlYXNlIGRvbnQgc3BhbSIsIHRyYW5zaWVudD1UcnVlLCBjbGllbnRzPVtjbGllbnRJRF0pCgkJCQkKCQkJZWxzZToKCQkJCXNwYW1tZXJzLnBvcChJRCkJCQoJCQkJYnNJbnRlcm5hbC5fY2hhdE1lc3NhZ2UoIldhcm4gbGltaXQgZXhjZWVkZWQuIEtpY2tpbmcge30gZm9yIHNwYW1taW5nLiIuZm9ybWF0KG5hbWUpKQoJCQkJI2JzSW50ZXJuYWwuX2NoYXRNZXNzYWdlKCJDaGF0RmlsdGVyIE1hZGUgQnkgQW5raXQiKQoJCQkJYnNJbnRlcm5hbC5fZGlzY29ubmVjdENsaWVudChjbGllbnRJRCkKCWVsc2U6IGNvdW50ZXJbSURdID0gMQoKZGVmIHJlc2V0KCk6CiAgICBnbG9iYWwgY291bnRlcgogICAgY291bnRlciA9IHt9CmlmIGhhY2suc3BhbVByb3RlY3Rpb246IHRpbWVyID0gYnMuVGltZXIoMjAwMCxyZXNldCx0aW1lVHlwZT0ncmVhbCcscmVwZWF0PVRydWUpIAo="))